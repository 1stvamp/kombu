
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>kombu - AMQP Messaging Framework for Python &mdash; Kombu v0.9.5 documentation</title>
    <link rel="stylesheet" href="static/celery.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="Kombu v0.9.5 documentation" href="index.html" />
    <link rel="next" title="User Guide" href="userguide/index.html" />
    <link rel="prev" title="Kombu Documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="userguide/index.html" title="User Guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Kombu Documentation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Kombu v0.9.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="kombu-amqp-messaging-framework-for-python">
<h1>kombu - AMQP Messaging Framework for Python<a class="headerlink" href="#kombu-amqp-messaging-framework-for-python" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Version:</th><td class="field-body">0.9.5</td>
</tr>
</tbody>
</table>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><cite>Kombu</cite> is an <a class="reference external" href="http://amqp.org">AMQP</a> messaging queue framework. AMQP is the Advanced Message
Queuing Protocol, an open standard protocol for message orientation, queuing,
routing, reliability and security.</p>
<p>The aim of <cite>Kombu</cite> is to make messaging in Python as easy as possible by
providing a high-level interface for producing and consuming messages,
and provide tested and proven implementations of common messaging patterns.</p>
<p><cite>Kombu</cite> has pluggable messaging transports, so it is possible to support
several messaging systems. Currently, there is support for <a class="reference external" href="http://amqp.org">AMQP</a>
(<a class="reference external" href="http://barryp.org/software/py-amqplib/">py-amqplib</a>, <a class="reference external" href="http://github.com/tonyg/pika">pika</a>), <a class="reference external" href="http://code.google.com/p/redis/">Redis</a>, and <cite>Beanstalk</cite>. Also there&#8217;s an
in-memory transport for testing purposes.</p>
<p>There are also transports available as plug-ins, like <cite>kombu-sqlalchemy</cite>
(SQLAlchemy transport), or <a class="reference external" href="http://github.com/ask/django-kombu/">django-kombu</a> (transport using the Django ORM).</p>
<p>Before you start playing with <cite>Kombu</cite>, you should probably read up on
AMQP, and you could start with the excellent article about using RabbitMQ
under Python, <a class="reference external" href="http://blogs.digitar.com/jjww/2009/01/rabbits-and-warrens/">Rabbits and warrens</a>. For more detailed information, you can
refer to the <a class="reference external" href="http://en.wikipedia.org/wiki/AMQP">Wikipedia article about AMQP</a>.</p>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>Kombu is using Sphinx, and the latest documentation is available at GitHub:</p>
<blockquote>
<a class="reference external" href="http://ask.github.com/kombu">http://ask.github.com/kombu</a></blockquote>
</div>
<div class="section" id="quick-overview">
<h2>Quick overview<a class="headerlink" href="#quick-overview" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>from kombu.connection BrokerConnection
from kombu.messaging import Exchange, Queue, Consumer, Producer

media_exchange = Exchange("media", "direct", durable=True)
video_queue = Queue("video", exchange=media_exchange, key="video")

# connections/channels
connection = BrokerConnection("localhost", "guest", "guest", "/")
channel = connection.channel()

# produce
producer = Producer(channel, exchange=media_exchange, serializer="json")
producer.publish({"name": "/tmp/lolcat1.avi", "size": 1301013})

# consume
consumer = Consumer(channel, video_queue)
consumer.register_callback(process_media)
consumer.consume()

# Process messages on all channels
while True:
    connection.drain_events()

# Consume from several queues on the same channel:
video_queue = Queue("video", exchange=media_exchange, key="video")
image_queue = Queue("image", exchange=media_exchange, key="image")

consumer = Consumer(channel, [video_queue, image_queue])
consumer.consume()

while True:
    connection.drain_events()</pre>
</div>
<p><cite>Exchange</cite> and <cite>Queue</cite> are simply declarations that can be pickled
and used in configuaration files etc.</p>
<p>They also support operations, but to do so they need to be bound
to a channel:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">exchange</span> <span class="o">=</span> <span class="n">Exchange</span><span class="p">(</span><span class="s">&quot;tasks&quot;</span><span class="p">,</span> <span class="s">&quot;direct&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span> <span class="o">=</span> <span class="n">BrokerConnection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">channel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bound_exchange</span> <span class="o">=</span> <span class="n">exchange</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bound_exchange</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

<span class="go"># the original exchange is not affected, and stays unbound.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exchange</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="go">raise NotBoundError: Can&#39;t call delete on Exchange not bound to</span>
<span class="go">    a channel.</span>
</pre></div>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>You can install <cite>Kombu</cite> either via the Python Package Index (PyPI)
or from source.</p>
<p>To install using <cite>pip</cite>,:</p>
<div class="highlight-python"><pre>$ pip install kombu</pre>
</div>
<p>To install using <cite>easy_install</cite>,:</p>
<div class="highlight-python"><pre>$ easy_install kombu</pre>
</div>
<p>If you have downloaded a source tarball you can install it
by doing the following,:</p>
<div class="highlight-python"><pre>$ python setup.py build
# python setup.py install # as root</pre>
</div>
</div>
<div class="section" id="terminology">
<h3>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<p>There are some concepts you should be familiar with before starting:</p>
<blockquote>
<ul>
<li><p class="first">Producers</p>
<blockquote>
<p>Producers sends messages to an exchange.</p>
</blockquote>
</li>
<li><p class="first">Exchanges</p>
<blockquote>
<p>Messages are sent to exchanges. Exchanges are named and can be
configured to use one of several routing algorithms. The exchange
routes the messages to consumers by matching the routing key in the
message with the routing key the consumer provides when binding to
the exchange.</p>
</blockquote>
</li>
<li><p class="first">Consumers</p>
<blockquote>
<p>Consumers declares a queue, binds it to a exchange and receives
messages from it.</p>
</blockquote>
</li>
<li><p class="first">Queues</p>
<blockquote>
<p>Queues receive messages sent to exchanges. The queues are declared
by consumers.</p>
</blockquote>
</li>
<li><p class="first">Routing keys</p>
<blockquote>
<p>Every message has a routing key.  The interpretation of the routing
key depends on the exchange type. There are four default exchange
types defined by the AMQP standard, and vendors can define custom
types (so see your vendors manual for details).</p>
<p>These are the default exchange types defined by AMQP/0.8:</p>
<blockquote>
<ul>
<li><p class="first">Direct exchange</p>
<blockquote>
<p>Matches if the routing key property of the message and
the <cite>routing_key</cite> attribute of the consumer are identical.</p>
</blockquote>
</li>
<li><p class="first">Fan-out exchange</p>
<blockquote>
<p>Always matches, even if the binding does not have a routing
key.</p>
</blockquote>
</li>
<li><p class="first">Topic exchange</p>
<blockquote>
<p>Matches the routing key property of the message by a primitive
pattern matching scheme. The message routing key then consists
of words separated by dots (<cite>&#8221;.&#8221;</cite>, like domain names), and
two special characters are available; star (<cite>&#8220;*&#8221;</cite>) and hash
(<cite>&#8220;#&#8221;</cite>). The star matches any word, and the hash matches
zero or more words. For example <cite>&#8220;*.stock.#&#8221;</cite> matches the
routing keys <cite>&#8220;usd.stock&#8221;</cite> and <cite>&#8220;eur.stock.db&#8221;</cite> but not
<cite>&#8220;stock.nasdaq&#8221;</cite>.</p>
</blockquote>
</li>
</ul>
</blockquote>
</blockquote>
</li>
</ul>
</blockquote>
</div>
<div class="section" id="getting-help">
<h3>Getting Help<a class="headerlink" href="#getting-help" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="mailing-list">
<h2>Mailing list<a class="headerlink" href="#mailing-list" title="Permalink to this headline">¶</a></h2>
<p>Join the <a class="reference external" href="http://groups.google.com/group/carrot-users/">carrot-users</a> mailing list.</p>
<div class="section" id="bug-tracker">
<h3>Bug tracker<a class="headerlink" href="#bug-tracker" title="Permalink to this headline">¶</a></h3>
<p>If you have any suggestions, bug reports or annoyances please report them
to our issue tracker at <a class="reference external" href="http://github.com/ask/kombu/issues/">http://github.com/ask/kombu/issues/</a></p>
</div>
<div class="section" id="contributing">
<h3>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h3>
<p>Development of <cite>Kombu</cite> happens at Github: <a class="reference external" href="http://github.com/ask/kombu">http://github.com/ask/kombu</a></p>
<p>You are highly encouraged to participate in the development. If you don&#8217;t
like Github (for some reason) you&#8217;re welcome to send regular patches.</p>
</div>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<p>This software is licensed under the <cite>New BSD License</cite>. See the <tt class="file docutils literal"><span class="pre">LICENSE</span></tt>
file in the top distribution directory for the full license text.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="index.html">
  <img class="logo" width="128" height="128" src="http://cloud.github.com/downloads/ask/kombu/kombusmall.jpg" alt="Logo"/>
</a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">kombu - AMQP Messaging Framework for Python</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#quick-overview">Quick overview</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#terminology">Terminology</a></li>
<li><a class="reference internal" href="#getting-help">Getting Help</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mailing-list">Mailing list</a><ul>
<li><a class="reference internal" href="#bug-tracker">Bug tracker</a></li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Kombu Documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="userguide/index.html"
                        title="next chapter">User Guide</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="sources/introduction.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="userguide/index.html" title="User Guide"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Kombu Documentation"
             >previous</a> |</li>
        <li><a href="index.html">Kombu v0.9.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2010, Ask Solem.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>